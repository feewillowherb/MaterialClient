## 登录页面

1. 该桌面端程序是一个单页面程序，隐藏原有的MainWindow.axaml页面(不再使用)
2. 页面流程：
   1. 启动程序-》进入Login.axaml页面-》检查是否有授权码-》没有授权码弹出输入授权码的小窗口-》有授权码让用户在Login页面输入账户密码-》验证成功后进入AttendedWeighingViewModel.axaml









### 基础平台的Http定义

基础平台host: http://base.publicapi.findong.com 在json中可配置





基础平台 Http相应结构

```
public class HttpResult<T> //这个类名不要沿用
{
    public int code { get; set; }
    public T data { get; set; }
    public string msg { get; set; }
    public bool success { get; set; }
}
```

获取授权码接口
Post api/AuthClientLicense/GetAuthClientLicense

参数：

```
{
"productCode": "5000" //固定5000
"code": "1234" //用户输入的
}
```

返回结果

```
HttpResult<LicenseInfo>
public class LicenseInfo
{
  /// <summary>
  /// 项目ID
  /// </summary>
  public Guid Proid { get; set; }
  /// <summary>
  /// 授权Token
  /// </summary>
  public Guid? AuthToken { get; set; }

  /// <summary>
  /// 授权时间
  /// </summary>
  public string AuthEndTime { get; set; }

  /// <summary>
  /// 机器码
  /// </summary>
  public string MachineCode { get; set; }

}
```



Post User/UserLogin

参数

```
{
	"userName": "",
	"userPwd": "",
	"proId": "",
}
```

返回结果

```
HttpResult<LoginUserDto>

public class LoginBaseDto
    {
        /// <summary>
        /// 用户Id
        /// </summary>
        public long UserId { get; set; }
        /// <summary>
        /// 用户名,必须是手机号
        /// </summary>
        public string UserName { get; set; }
        /// <summary>
        /// 客户端标识 
        /// </summary>
        public Guid ClientId { get; set; }
    }
    public class LoginUserDto : LoginBaseDto
    {
        /// <summary>
        /// 真实姓名
        /// </summary>
        public string TrueName { get; set; }
        /// <summary>
        /// 是否管理员
        /// </summary>
        public bool IsAdmin { get; set; }
        /// <summary>
        /// 是否企业
        /// </summary>
        public bool IsCompany { get; set; }
        /// <summary>
        /// 产品分类（1旧版本，2新版本）
        /// </summary>
        public int ProductType { get; set; }
        /// <summary>
        /// 产品Id
        /// </summary>
        public long FromProductId { get; set; }
        /// <summary>
        /// 产品Id
        /// </summary>
        public long ProductId { get; set; }
        /// <summary>
        /// 产品名称
        /// </summary>
        public string ProductName { get; set; }
        /// <summary>
        /// 登录企业名称
        /// </summary>
        public int CoId { get; set; }
        /// <summary>
        /// 公司项目名称
        /// </summary>
        public string CoName { get; set; }
        /// <summary>
        /// 产品路径
        /// </summary>
        public string Url { get; set; }
        /// <summary>
        /// 用户登录Token
        /// </summary>
        public string Token { get; set; }
        /// <summary>
        /// 授权到期时间
        /// </summary>
        public DateTime? AuthEndTime { get; set; }
    }
```



